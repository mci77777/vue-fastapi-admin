# 技术栈与依赖

<cite>
**本文档引用的文件**  
- [pyproject.toml](file://pyproject.toml)
- [web/package.json](file://web/package.json)
- [app/core/init_app.py](file://app/core/init_app.py)
- [app/settings/config.py](file://app/settings/config.py)
- [web/vite.config.js](file://web/vite.config.js)
- [web/src/main.js](file://web/src/main.js)
</cite>

## 目录
1. [简介](#简介)
2. [后端技术栈](#后端技术栈)
3. [前端技术栈](#前端技术栈)
4. [依赖管理机制](#依赖管理机制)
5. [环境搭建与版本兼容性](#环境搭建与版本兼容性)
6. [总结](#总结)

## 简介
本项目采用前后端分离架构，后端基于 Python 异步生态构建，前端使用现代 Vue3 生态系统。整体技术选型注重开发效率、可维护性与性能表现。后端使用 FastAPI 作为 Web 框架，结合 Tortoise-ORM 实现异步数据库操作，Pydantic 提供数据验证与序列化支持，Uvicorn 作为 ASGI 服务器运行服务，Aerich 负责数据库迁移管理。前端采用 Vue3 响应式框架，Vite 作为构建工具，Pinia 进行状态管理，Vue Router 实现路由控制，Naive UI 提供组件库支持，UnoCSS 实现原子化 CSS 样式，Axios 处理 HTTP 请求。依赖分别通过 `pyproject.toml` 和 `package.json` 精确管理，确保开发环境一致性。

## 后端技术栈

### FastAPI（Web 框架）
FastAPI 是一个现代、快速（高性能）的 Python Web 框架，基于标准 Python 类型注解构建。它利用 Starlette 作为 ASGI 核心，支持异步处理，适合高并发场景。在本项目中，FastAPI 作为核心服务框架，负责路由分发、请求处理、自动生成 OpenAPI 文档（Swagger UI）等功能。其高性能和自动文档生成能力极大提升了开发效率。

**Section sources**  
- [app/core/init_app.py](file://app/core/init_app.py#L1-L234)

### Tortoise-ORM（异步 ORM）
Tortoise-ORM 是一个异步的 ORM 框架，专为 asyncio 设计，语法类似 Django ORM，但完全异步。项目中使用 Tortoise-ORM 定义数据模型（位于 `app/models`），执行数据库增删改查操作。通过配置支持 SQLite、MySQL、PostgreSQL 等多种数据库，当前默认使用 SQLite（`db.sqlite3`），便于快速部署和测试。

**Section sources**  
- [app/settings/config.py](file://app/settings/config.py#L1-L95)

### Pydantic（数据验证与序列化）
Pydantic 提供强大的数据验证和序列化功能，基于 Python 类型提示实现。项目中广泛用于定义 API 请求/响应模型（位于 `app/schemas`），确保输入输出数据的合法性。同时，Pydantic Settings 模块用于加载和验证环境配置（如 `Settings` 类），提升配置安全性。

**Section sources**  
- [app/settings/config.py](file://app/settings/config.py#L1-L95)

### Uvicorn（ASGI 服务器）
Uvicorn 是一个基于 uvloop 和 httptools 的高性能 ASGI 服务器，用于运行 FastAPI 应用。它支持异步处理，能够高效应对大量并发请求。项目通过 `run.py` 或直接调用 Uvicorn 启动服务，配置了热重载模式以支持开发阶段的快速迭代。

**Section sources**  
- [pyproject.toml](file://pyproject.toml#L1-L90)

### Aerich（数据库迁移工具）
Aerich 是 Tortoise-ORM 官方推荐的数据库迁移工具，类似于 Django 的 migrations 或 Alembic。它能够根据模型变化自动生成迁移脚本，并安全地升级或回滚数据库结构。项目中通过 `init_db` 函数初始化 Aerich 命令，自动执行迁移操作，确保数据库结构与代码模型一致。

**Section sources**  
- [app/core/init_app.py](file://app/core/init_app.py#L1-L234)
- [pyproject.toml](file://pyproject.toml#L85-L90)

## 前端技术栈

### Vue3（响应式框架）
Vue3 是新一代渐进式 JavaScript 框架，采用 Composition API 和 Proxy 响应式系统，性能更优，逻辑组织更清晰。项目中所有页面组件（如 `views/system/user/index.vue`）均基于 Vue3 构建，利用 `<script setup>` 语法简化代码结构，提升开发体验。

**Section sources**  
- [web/src/main.js](file://web/src/main.js#L1-L27)

### Vite（构建工具）
Vite 是新一代前端构建工具，基于 ES Modules 和原生浏览器支持，提供极快的冷启动和热更新速度。项目通过 `vite.config.js` 配置开发服务器、别名、插件等，支持代理转发（用于解决跨域）、代码压缩、环境变量注入等功能，显著提升开发效率。

**Section sources**  
- [web/vite.config.js](file://web/vite.config.js#L1-L45)

### Pinia（状态管理）
Pinia 是 Vue 官方推荐的状态管理库，替代 Vuex，API 更简洁，支持 TypeScript 更好。项目中通过 `store/modules` 组织全局状态（如用户信息、权限、标签页等），在 `setupStore` 中注册，实现跨组件状态共享与响应式更新。

**Section sources**  
- [web/src/main.js](file://web/src/main.js#L1-L27)

### Vue Router（路由）
Vue Router 是 Vue 的官方路由管理器，支持嵌套路由、动态路由、懒加载等功能。项目中定义了系统管理、登录、工作台等多级路由，结合布局组件（`layout/index.vue`）实现页面结构控制，并通过路由守卫（`auth-guard.js`）实现权限拦截。

**Section sources**  
- [web/src/main.js](file://web/src/main.js#L1-L27)

### Naive UI（组件库）
Naive UI 是一个功能丰富、类型友好的 Vue3 组件库，提供大量高质量 UI 组件（如表格、表单、弹窗等）。项目中广泛使用其组件构建管理后台界面，结合 TypeScript 提供完整的类型提示，提升开发效率和代码健壮性。

**Section sources**  
- [web/package.json](file://web/package.json#L1-L61)

### UnoCSS（原子化 CSS）
UnoCSS 是一个即时、可定制的原子化 CSS 引擎，按需生成样式，体积小、性能高。项目中通过 `unocss.config.js` 配置规则，结合 Vite 插件使用，在模板中直接书写类名（如 `flex`, `p-4`），实现高效样式开发，避免传统 CSS 的冗余问题。

**Section sources**  
- [web/vite.config.js](file://web/vite.config.js#L1-L45)
- [web/package.json](file://web/package.json#L1-L61)

### Axios（HTTP 客户端）
Axios 是一个基于 Promise 的 HTTP 客户端，支持浏览器和 Node.js。项目中用于发送 RESTful API 请求，封装了请求/响应拦截器（`http/interceptors.js`），统一处理认证 Token、错误提示、加载状态等，简化 API 调用逻辑。

**Section sources**  
- [web/package.json](file://web/package.json#L1-L61)

## 依赖管理机制

### Python 依赖：pyproject.toml
项目使用 `pyproject.toml` 作为 Python 依赖管理文件，符合现代 Python 项目标准。所有依赖（包括 FastAPI、Tortoise-ORM、Pydantic、Uvicorn、Aerich 等）均在此文件中声明，版本锁定精确，确保环境一致性。通过 `poetry` 或 `pip` 安装依赖时，可完全复现开发环境。

```toml
[project]
dependencies = [
    "fastapi==0.111.0",
    "tortoise-orm==0.23.0",
    "pydantic==2.10.5",
    "uvicorn==0.34.0",
    "aerich==0.8.1",
    # ...
]
```

**Section sources**  
- [pyproject.toml](file://pyproject.toml#L1-L90)

### 前端依赖：package.json
前端依赖通过 `package.json` 管理，使用 `pnpm` 作为包管理器（由 `pnpm-lock.yaml` 锁定版本）。`dependencies` 包含运行时所需库（如 Vue、Pinia、Naive UI），`devDependencies` 包含构建工具（如 Vite、ESLint）。通过 `npm run dev` 启动开发服务器，`npm run build` 构建生产包。

```json
{
  "dependencies": {
    "vue": "^3.3.4",
    "pinia": "^2.1.6",
    "vue-router": "^4.2.4",
    "naive-ui": "^2.34.4",
    "axios": "^1.4.0",
    "unocss": "^0.55.0"
  },
  "devDependencies": {
    "vite": "^4.4.6",
    "@vitejs/plugin-vue": "^4.2.3"
  }
}
```

**Section sources**  
- [web/package.json](file://web/package.json#L1-L61)

## 环境搭建与版本兼容性

### 开发环境要求
- **Python**: 3.11+
- **Node.js**: 16+
- **包管理器**: `pip` / `poetry`（Python），`pnpm`（前端）

### 安装步骤
1. **后端依赖安装**：
   ```bash
   pip install -r requirements.txt
   # 或使用 poetry
   poetry install
   ```

2. **前端依赖安装**：
   ```bash
   cd web
   pnpm install
   ```

3. **启动服务**：
   - 后端：`uvicorn run:app --reload`
   - 前端：`npm run dev`

### 版本兼容性说明
- FastAPI 0.111.0 与 Pydantic 2.x 兼容，使用 `pydantic-settings` 进行配置管理。
- Tortoise-ORM 0.23.0 支持异步操作，与 Aerich 0.8.1 配合良好。
- Vue3 3.3+ 与 Vite 4.x、Pinia 2.x、Vue Router 4.x 完全兼容。
- UnoCSS 0.55+ 提供高效原子化样式支持，与 Vite 深度集成。

确保所有依赖版本与 `pyproject.toml` 和 `package.json` 一致，避免因版本冲突导致运行错误。

## 总结
本项目技术栈选型合理，后端基于 FastAPI + Tortoise-ORM + Pydantic + Uvicorn + Aerich 构建高性能异步服务，前端采用 Vue3 + Vite + Pinia + Vue Router + Naive UI + UnoCSS + Axios 打造现代化管理界面。依赖通过 `pyproject.toml` 和 `package.json` 精确管理，确保开发环境可复现。整体架构清晰，易于维护和扩展，适合中后台管理系统开发。