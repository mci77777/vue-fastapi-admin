# Dashboard 用户使用手册

**文档版本**: v1.0  
**创建时间**: 2025-10-12  
**适用版本**: Dashboard v1.0

---

## 📋 目录

1. [快速开始](#1-快速开始)
2. [Dashboard 概览](#2-dashboard-概览)
3. [统计指标说明](#3-统计指标说明)
4. [实时数据更新](#4-实时数据更新)
5. [系统日志查看](#5-系统日志查看)
6. [用户活跃度分析](#6-用户活跃度分析)
7. [常见问题](#7-常见问题)

---

## 1. 快速开始

### 1.1 访问 Dashboard

1. 打开浏览器，访问：http://your-domain.com
2. 使用管理员账户登录
3. 点击左侧菜单 **"Dashboard"**

### 1.2 界面布局

```
┌─────────────────────────────────────────────────────────┐
│ Dashboard                          [刷新] [配置]         │
├─────────────────────────────────────────────────────────┤
│ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐               │
│ │日活 │ │AI请 │ │Token│ │API  │ │JWT  │  统计横幅     │
│ │用户 │ │求数 │ │使用 │ │连通 │ │可获 │               │
│ └─────┘ └─────┘ └─────┘ └─────┘ └─────┘               │
├─────────────────────────────────────────────────────────┤
│ ┌──────────┐ ┌────────────────────────────────────┐    │
│ │系统日志  │ │用户活跃度图表                      │    │
│ │          │ │                                    │    │
│ │ERROR/WARN│ │                                    │    │
│ │          │ │                                    │    │
│ └──────────┘ └────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────┘
```

---

## 2. Dashboard 概览

### 2.1 统计横幅

Dashboard 顶部显示 5 个核心指标，每个指标卡片包含：

- **图标**：使用 Heroicons 专业图标
- **统计值**：实时数据（每 10 秒自动刷新）
- **标签**：指标名称
- **详情按钮**：点击查看详细信息

### 2.2 实时状态指示器

右上角显示 WebSocket 连接状态：

- 🟢 **"WebSocket 已连接"**：实时数据正常更新
- 🔴 **"WebSocket 已断开"**：自动降级为 HTTP 轮询（30 秒刷新）

### 2.3 工具栏按钮

- **刷新按钮**：手动刷新所有统计数据
- **配置按钮**：调整轮询间隔（仅在 WebSocket 断开时可用）

---

## 3. 统计指标说明

### 3.1 日活用户数

**定义**：最近 24 小时内至少发起 1 次请求的唯一用户数

**计算方式**：
- 统计时间窗口：最近 24 小时
- 数据来源：`user_activity_stats` 表
- 更新频率：每 10 秒

**点击查看详情**：
- 用户类型分布（永久用户 vs 匿名用户）
- 活跃时段分布
- 请求数分布

**业务价值**：
- 衡量平台活跃度
- 识别用户增长趋势
- 评估营销活动效果

---

### 3.2 AI 请求数

**定义**：最近 24 小时内的 AI 对话请求总数

**计算方式**：
- 统计时间窗口：最近 24 小时
- 数据来源：`ai_request_stats` 表
- 更新频率：每 10 秒

**点击查看详情**：
- 请求成功率
- 平均延迟
- 热门模型排行

**业务价值**：
- 衡量 AI 服务使用量
- 评估服务质量
- 预测资源需求

---

### 3.3 Token 使用量

**定义**：最近 24 小时内消耗的 AI Token 总数

**计算方式**：
- 统计时间窗口：最近 24 小时
- 数据来源：`ai_request_stats` 表（`total_tokens` 字段）
- 更新频率：每 10 秒

**点击查看详情**：
- Token 消耗趋势
- 成本估算
- 用户消耗排行

**业务价值**：
- 成本控制
- 资源规划
- 用户配额管理

**注意**：当前版本显示为 0，后续版本将实现完整统计。

---

### 3.4 API 连通性

**定义**：当前在线的 AI 端点数量 / 总端点数量

**计算方式**：
- 数据来源：`EndpointMonitor` 服务
- 更新频率：每 10 秒
- 健康检查：每 5 分钟探测一次

**点击查看详情**：
- 在线端点列表
- 离线端点列表
- 最近故障记录

**业务价值**：
- 服务可用性监控
- 故障快速定位
- SLA 达成率评估

---

### 3.5 JWT 可获取性

**定义**：最近 1 小时内 JWT 认证成功率

**计算方式**：
- 统计时间窗口：最近 1 小时
- 数据来源：Prometheus 指标 `auth_requests_total`
- 更新频率：每 10 秒

**点击查看详情**：
- 成功率趋势
- 失败原因分布
- 平均响应时间

**业务价值**：
- 认证服务质量监控
- 用户登录体验评估
- 安全事件检测

---

## 4. 实时数据更新

### 4.1 WebSocket 模式（默认）

**特点**：
- 实时推送，延迟 < 100ms
- 自动重连（最多 3 次）
- 低资源消耗

**适用场景**：
- 需要实时监控
- 网络稳定

### 4.2 HTTP 轮询模式（降级）

**特点**：
- 定时拉取，默认 30 秒
- 可配置间隔（10s - 300s）
- 兼容性好

**适用场景**：
- WebSocket 连接失败
- 防火墙限制
- 低频监控

**配置方法**：
1. 点击右上角 **"配置"** 按钮
2. 调整 **"轮询间隔"**（10 - 300 秒）
3. 点击 **"保存"**

---

## 5. 系统日志查看

### 5.1 日志级别

Dashboard 左侧显示系统日志，支持 3 个级别：

- **ERROR**：错误日志（红色）
- **WARNING**：警告日志（黄色）
- **INFO**：信息日志（蓝色）

### 5.2 日志内容

每条日志包含：
- **时间戳**：精确到秒
- **级别**：ERROR/WARNING/INFO
- **用户 ID**：触发日志的用户（如有）
- **消息**：日志详情

### 5.3 日志操作

- **点击日志**：复制到剪贴板
- **切换级别**：顶部下拉菜单选择
- **刷新日志**：点击 **"🔄 刷新"** 按钮

### 5.4 日志保留

- **内存缓存**：最近 100 条
- **磁盘日志**：保留 30 天（`logs/` 目录）

---

## 6. 用户活跃度分析

### 6.1 图表类型

Dashboard 右侧显示用户活跃度图表，支持 3 种时间范围：

- **最近 1 小时**：每 5 分钟一个数据点
- **最近 24 小时**：每小时一个数据点
- **最近 7 天**：每天一个数据点

### 6.2 图表交互

- **切换时间范围**：顶部下拉菜单选择
- **悬停查看详情**：鼠标悬停在数据点上
- **缩放**：鼠标滚轮缩放图表
- **拖拽**：按住鼠标左键拖拽图表

### 6.3 数据维度

图表显示以下维度：

- **活跃用户数**：蓝色折线
- **永久用户数**：绿色折线
- **匿名用户数**：橙色折线

---

## 7. 常见问题

### 7.1 统计数据显示为 0

**原因**：
- 系统刚启动，数据尚未生成
- 数据库连接失败
- 统计服务未启动

**解决方法**：
1. 等待 1-2 分钟，数据会自动更新
2. 点击 **"刷新"** 按钮手动刷新
3. 联系管理员检查后端日志

---

### 7.2 WebSocket 连接失败

**原因**：
- 网络不稳定
- 防火墙阻止 WebSocket
- 后端服务异常

**解决方法**：
1. 检查网络连接
2. 刷新页面重新连接
3. 系统会自动降级为 HTTP 轮询

---

### 7.3 图表加载缓慢

**原因**：
- 数据量过大
- 网络延迟
- 浏览器性能不足

**解决方法**：
1. 切换到较短的时间范围（如 1 小时）
2. 清除浏览器缓存
3. 使用现代浏览器（Chrome/Edge/Firefox）

---

### 7.4 日志不更新

**原因**：
- 日志级别过滤
- 系统无新日志产生
- 日志收集服务异常

**解决方法**：
1. 切换日志级别为 **"INFO"**
2. 点击 **"🔄 刷新"** 按钮
3. 联系管理员检查后端日志

---

## 8. 性能优化建议

### 8.1 浏览器要求

- **推荐浏览器**：Chrome 90+, Edge 90+, Firefox 88+
- **最低分辨率**：1200x800
- **网络带宽**：≥ 1Mbps

### 8.2 使用技巧

- **定期刷新**：避免长时间停留在 Dashboard 页面
- **关闭不用的标签页**：减少内存占用
- **使用快捷键**：`F5` 刷新页面，`Ctrl+R` 硬刷新

---

## 9. 快捷键

| 快捷键 | 功能 |
|--------|------|
| `F5` | 刷新页面 |
| `Ctrl+R` | 硬刷新（清除缓存）|
| `Ctrl+Shift+I` | 打开开发者工具 |
| `Esc` | 关闭详情弹窗 |

---

## 10. 联系支持

**遇到问题？**

- 📧 邮件：support@example.com
- 💬 在线客服：http://your-domain.com/support
- 📚 文档中心：http://your-domain.com/docs

---

**文档更新时间**: 2025-10-12  
**下次审查**: 2025-11-12

